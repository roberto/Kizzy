/*!
  * Kizzy - a cross-browser LocalStorage API
  * Copyright: Dustin Diaz 2012
  * https://github.com/ded/kizzy
  * License: MIT
  */
!function(e,t){typeof module!="undefined"?module.exports=t():typeof define=="function"&&typeof define.amd=="object"?define(t):this[e]=t()}("kizzy",function(){function e(){}function v(){return+(new Date)}function m(e,t){e._[t]&&e._[t].e&&e._[t].e<v()&&e.remove(t)}function g(e){return typeof e=="number"&&isFinite(e)}function y(e){return localStorage[e]}function b(e,t){return localStorage[e]=t,t}function w(e){delete localStorage[e]}function E(){localStorage.clear()}function S(e){var t=f.childNodes,n,r=null;for(var i=0,s=t.length;i<s;i++){n=t.item(i);if(n.getAttribute("key")==e){r=n;break}}return r}function x(e){var t=S(e),n=null;return t&&(n=t.getAttribute("value")),n}function T(e,t){var n=S(e);return n?n.setAttribute("value",t):(n=a.createNode(1,"item",""),n.setAttribute("key",e),n.setAttribute("value",t),f.appendChild(n)),u.save(r),t}function N(e){S(e)&&f.removeChild(node),u.save(r)}function C(){while(f.firstChild)f.removeChild(f.firstChild);u.save(r)}function k(){this._={}}function L(e){this.ns=e,this._=JSON.parse(h(e)||"{}")}function A(e){return new L(e)}var t,n=document,r=n.domain,i=0,s=function(){return 1};try{t=!!localStorage||!!globalStorage,localStorage||(localStorage=globalStorage[r]),i=1}catch(o){i=0;try{if(n.documentElement.addBehavior){i=0,t=1;var u=n.documentElement;u.addBehavior("#default#userData"),u.load(r);var a=u.xmlDocument,f=a.documentElement}}catch(l){t=!1}}var c=e,h=e,p=e,d=e;return t&&(c=i?b:T,h=i?y:x,p=i?w:N,d=i?E:C,s=function(e){try{var t=JSON.stringify(e._);return t=="{}"?p(e.ns):c(e.ns,t),1}catch(n){return 0}}),k.prototype={set:function(e,t,n){return this._[e]={value:t,e:g(n)?v()+n:0},s(this)||this.remove(e),t},get:function(e){return m(this,e),this._[e]?this._[e].value:undefined},getAll:function(){var e={};for(var t in this._)e[t]=this.get(t);return e},remove:function(e){delete this._[e],s(this)},clear:function(){this._={},s(this)},clearExpireds:function(){for(var e in this._)m(this,e);s(this)}},L.prototype=k.prototype,A.remove=p,A.clear=d,A})